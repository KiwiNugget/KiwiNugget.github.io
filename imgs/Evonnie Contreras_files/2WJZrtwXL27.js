/*!CK:4091507131!*//*1430718803,*/

if (self.CavalryLogger) { CavalryLogger.start_js(["nJcRw"]); }

__d("TimelineAppSectionConstants",[],function(a,b,c,d,e,f){b.__markCompiled&&b.__markCompiled();e.exports={collectionTabKeyToAppTabKey:{friends_recent:"friends",friends_all:"friends",friends_mutual:"friends",photos_of:"photos",photos_all:"photos",photos_albums:"photos",likes_recent:null,info_all:"about",music_my_music:"music",music_favs:"music",music_playlists:"music",books_read:"books",books_favorite:"books",books_want:"books",recent_places:null,fitness_overview:"fitness",friends_featured:null,places_want:null,info_contact:null,fitness_running:"fitness",fitness_cycling:"fitness",friends_followers:"friends",friends_following:"friends",music_radio:"music",info_history:null,recent_games:"games",products_want:null,photos_archive:"photos",notes_my_notes:"notes",notes_drafts:"notes",notes_about_me:"notes",likes_other:"likes",video_movies_watch:"movies",video_tv_shows_watch:"tv",music_saved:"music",video_movies_want:"movies",video_tv_shows_want:"tv",video_movies_favorite:"movies",video_tv_shows_favorite:"tv",friends_high_school:"friends",friends_college:"friends",friends_work:"friends",friends_suggested:"friends",apps_like:"games",upcoming_events:"events",past_events:"events",likes_people:"likes",likes_sports:null,fitness_report:null,groups_member:"groups",music_heavy_rotation:"music",photos_album:"photos",photos_untagged:"photos",music_mutual:"music",likes_restaurants:"likes",likes_clothing:null,info_insights:null,apps_used:"games",games_play:"games",games_apps_saved:"games",video_movies_suggestions:null,video_tv_shows_suggestions:null,books_suggestions:null,saved_books:"saved",saved_movies:"saved",saved_tv_shows:"saved",saved_music:"saved",places_saved:"map",saved_links:"saved",sports_teams:"sports",likes_all:"likes",saved_places:"saved",saved_all:"saved",sports_athletes:"sports",sports_activities:null,saved_events:"saved",saved_archived:"saved",places_recent:"map",places_visited:"map",reviews_written:"reviews",likes_section_movies:"likes",likes_section_tv_shows:"likes",likes_section_books:"likes",likes_section_music:"likes",likes_section_sports_teams:"likes",place_visits_by_place_tag:null,places_cities:"map",place_visits_by_city:null,topic_visit_counts:"map",place_visits_by_topic:null,place_visit_stories:null,places_map:"map",likes_section_apps_and_games:"likes",likes_section_sports_athletes:"likes",places_cities_desktop:"map",saved_videos:"saved",saved_pages:"saved",friends_with_upcoming_birthdays:"friends",friends_current_city:"friends",friends_hometown:"friends",at_work_contact:null,place_reviews_written:"reviews",movie_reviews_written:"reviews",tv_show_reviews_written:"reviews",book_reviews_written:"reviews",photos_all_expanded:"photos",videos_by_user:"videos",videos_user_tagged:"videos",external_videos_for_user:"videos",friends_map:"friends",videos_user_all:"videos",info_about:null,info_all_relationships:null,info_contact_basic:null,info_edu_work:null,info_overview:null,info_places:null,info_at_work:null,info_year_overviews:null,followers:"friends",following:"friends",media_set:"photos",photos_stream:"photos",photos_synced:"photos",apps:"games",videos_by:"videos",videos_of:"videos"}};},null);
__d("TimelinePageLoadParam",[],function(a,b,c,d,e,f){b.__markCompiled&&b.__markCompiled();e.exports={REQUEST_PARAM_NAME:"tipld",LAST_RANKED_UNIT_TIME:"rt",REPORT_UNIT_COUNT:"rc",STORY_UNIT_COUNT:"sc",VISIBLE_UNIT_COUNT:"vc"};},null);
__d("onViewportChanged",["EventListener","emptyFunction","getViewportDimensions","requestAnimationFrame"],function(a,b,c,d,e,f,g,h,i,j){b.__markCompiled&&b.__markCompiled();var k=[],l=false,m=null,n,o;function p(){var aa=i.withoutScrollbars();return {top:0,bottom:aa.height,left:0,right:aa.width};}function q(aa,ba){var ca={transform:ba||h.thatReturnsArgument,callback:aa,needsUpdate:true};k.push(ca);x();s();return {remove:r.bind(null,ca),scheduleCheck:v.bind(null,ca)};}function r(aa){var ba=k.indexOf(aa);if(ba!==-1){k.splice(ba,1);if(k.length===0){t();m=null;}}}function s(){if(!o){o=g.listen(window,'scroll',w);n=g.listen(window,'resize',u);}}function t(){if(o){o.remove();n.remove();o=n=null;}}function u(){m=null;w();}function v(aa){aa.needsUpdate=true;x();}function w(){k.map(function(aa){return aa.needsUpdate=true;});x();}function x(){if(!l){l=true;j(function(){l=false;z();});}}function y(aa){if(aa.needsUpdate){aa.needsUpdate=false;return true;}return false;}function z(){if(!m)m=p();var aa=k.filter(y),ba=aa.map(function(ca){return ca.transform.call(null,m);});aa.forEach(function(ca,da){return ca.callback.call(null,ba[da]);});}e.exports=q;},null);
__d("onRectIsWithinViewport",["onViewportChanged"],function(a,b,c,d,e,f,g){b.__markCompiled&&b.__markCompiled();function h(j,k){return !(j.bottom<k.top||j.top>k.bottom||j.right<k.left||j.left>k.right);}function i(j,k){var l;function m(o){var p=j();return !!p&&h(p,o);}function n(o){if(l!==o){l=o;k(o);}}return g(n,m);}e.exports=i;},null);
__d("OnVisible.react",["React","getElementRect","onRectIsWithinViewport","onlyChild"],function(a,b,c,d,e,f,g,h,i,j){b.__markCompiled&&b.__markCompiled();var k=g,l=k.PropTypes,m=g.createClass({displayName:"OnVisible",propTypes:{onVisible:l.func,onHidden:l.func,buffer:l.number},componentDidMount:function(){this._createListener();},componentDidUpdate:function(){this._createListener();},componentWillUnmount:function(){this._removeListener();},reset:function(){this._removeListener();this._createListener();},check:function(){if(this._listener)this._listener.scheduleCheck();},_measureElementRect:function(){if(!this.isMounted())return null;var n=this.props.buffer||0,o=h(g.findDOMNode(this));o.left-=n;o.right+=n;o.top-=n;o.bottom+=n;return o;},_createListener:function(){var n=g.findDOMNode(this);if(this._listener&&n!==this._element)this._removeListener();if(!this._listener){this._element=n;this._listener=i(this._measureElementRect,function(o){var p=o?this.props.onVisible:this.props.onHidden;p&&p();}.bind(this));}},_removeListener:function(){if(this._listener){this._listener.remove();this._listener=null;}},render:function(){return j(this.props.children);}});e.exports=m;},null);
__d("Optimus",["Event","Parent"],function(a,b,c,d,e,f,g,h){b.__markCompiled&&b.__markCompiled();'use strict';var i={};function j(l,m){var n=m.getTarget();if(!n)return;var o=i[l];for(var p in o){var q=h.byAttribute(n,p);if(q)do{var r=o[p][q.getAttribute(p)];if(r&&r.handleOptimus(l,q,m)===false)break;}while(q=h.byAttribute(q.parentNode,p));}}function k(l,m,n,o){if(!i[l]){i[l]={};g.listen(document.documentElement,l,j.bind(null,l));}if(!i[l][m])i[l][m]={};if(!i[l][m][n])i[l][m][n]=o;}e.exports={addRelClick:function(l,m){k('click','rel',l,m);},addEventListener:k};},null);
__d("PopoverMenuShowOnHover",["Event"],function(a,b,c,d,e,f,g){b.__markCompiled&&b.__markCompiled();var h=250;function i(j){"use strict";this._popoverMenu=j;this._listeners=[];}i.prototype.enable=function(){"use strict";this._attachMouseListeners(this._popoverMenu.getTriggerElem());this._setMenuSubscription=this._popoverMenu.subscribe('setMenu',this._onSetMenu.bind(this));};i.prototype.disable=function(){"use strict";while(this._listeners.length)this._listeners.pop().remove();if(this._setMenuSubscription){this._setMenuSubscription.unsubscribe();this._setMenuSubscription=null;}};i.prototype._onSetMenu=function(){"use strict";this._attachMouseListeners(this._popoverMenu.getPopover().getLayer().getRoot());};i.prototype._attachMouseListeners=function(j){"use strict";var k=this._popoverMenu.getPopover(),l=null;this._listeners.push(g.listen(j,'mouseleave',k.hideLayer.bind(k)),g.listen(j,'mouseenter',function(){l=Date.now();k.showLayer();}),g.listen(j,'click',function(m){if(Date.now()<l+h)m.stop();}));};e.exports=i;},null);
__d("ProfileActionBarLogger",["FBJSON","MarauderLogger","Optimus"],function(a,b,c,d,e,f,g,h,i){b.__markCompiled&&b.__markCompiled();function j(){i.addEventListener('mouseup','data-loggable','ProfileHighQualityLogger',{handleOptimus:function(k,l,m){h.log('profile_high_quality_action',null,g.parse(l.getAttribute('data-store')));return false;}});}f.init=j;},null);
__d("ProfileInfoRequestNoteFlyout",["CSS","csx","DOM","Event","LayerDestroyOnHide","tidyEvent"],function(a,b,c,d,e,f,g,h,i,j,k,l){b.__markCompiled&&b.__markCompiled();function m(n,o){"use strict";this.$ProfileInfoRequestNoteFlyout0=o;this.$ProfileInfoRequestNoteFlyout1=i.scry(this.$ProfileInfoRequestNoteFlyout0.getContentRoot(),"._958")[0];l(j.listen(n,'click',this.$ProfileInfoRequestNoteFlyout2.bind(this)));l(this.$ProfileInfoRequestNoteFlyout0.subscribe('success',this.$ProfileInfoRequestNoteFlyout3.bind(this)));l(this.$ProfileInfoRequestNoteFlyout0.subscribe('hide',this.$ProfileInfoRequestNoteFlyout4.bind(this)));l(this.$ProfileInfoRequestNoteFlyout0.subscribe('error',this.$ProfileInfoRequestNoteFlyout5.bind(this)));}m.prototype.$ProfileInfoRequestNoteFlyout2=function(n){"use strict";this.$ProfileInfoRequestNoteFlyout0.show();n.kill();};m.prototype.$ProfileInfoRequestNoteFlyout5=function(n,o){"use strict";i.setContent(this.$ProfileInfoRequestNoteFlyout1,o.response.errorDescription);g.show(this.$ProfileInfoRequestNoteFlyout1);return false;};m.prototype.$ProfileInfoRequestNoteFlyout4=function(){"use strict";g.hide(this.$ProfileInfoRequestNoteFlyout1);};m.prototype.$ProfileInfoRequestNoteFlyout3=function(){"use strict";this.$ProfileInfoRequestNoteFlyout0.enableBehavior(k);this.$ProfileInfoRequestNoteFlyout0.hide();};e.exports=m;},null);
__d("ProfileEscapeHatch",["CSS","ProfileTabUtils","Run","TimelineComponentKeys","TimelineController"],function(a,b,c,d,e,f,g,h,i,j,k){b.__markCompiled&&b.__markCompiled();var l=[],m=false;function n(o){"use strict";this.$ProfileEscapeHatch0=o;l.push(this);if(!m){k.register(j.ESCAPE_HATCH,n);i.onLeave(function(){l=[];});m=true;}}n.handleTabChange=function(o){"use strict";l.forEach(function(p){g.conditionShow(p.$ProfileEscapeHatch0,h.isTimelineTab(o));});};e.exports=n;},null);
__d("TimelineURI",["BizSiteIdentifier.brands","BusinessURI.brands","ProfileTabConst","TimelineAppSectionConstants","URI","goURI"],function(a,b,c,d,e,f,g,h,i,j,k,l){b.__markCompiled&&b.__markCompiled();var m={parseURI:function(n){n=k(n);var o=n.getQueryData(),p=n.getPath(),q=p.split('/').slice(1);if(q[0]=='people'||q[0]=='pages')q=q.slice(2);var r=o.sk||q[1]||i.TIMELINE;if(r==i.WALL)r=i.TIMELINE;var s=null,t=null;if(r==i.TIMELINE){t=parseInt(q[2],10)||null;s=parseInt(q[3],10)||null;}return {path:p,id:o.id||q[0],key:r,viewas:o.viewas?o.viewas:0,filter:o.filter?o.filter:null,year:t,month:s,friendship:!!o.and};},goToProfileID:function(n){if(g.isBizSite()){l(h('/profile.php').addQueryData('id',n),true);}else l(k('/'+n),true);},getTabKeyFromURI:function(n){var o=m.getSectionKeyFromURI(n);return j.collectionTabKeyToAppTabKey[o]||o;},getSectionKeyFromURI:function(n){return n.getQueryData().sk||n.getPath().split('/')[2];},getVanityFromURI:function(n){if(n.getQueryData().id)return n.getQueryData.id;return n.getPath().split('/')[1];},isVideoPermalink:function(n){return (m.getTabKeyFromURI(n)===i.VIDEOS&&n.getPath().split('/').filter(function(o){return !!o;}).length>2);}};e.exports=m;},null);
__d("ProfileNavigation",["Arbiter","CSS","PageTransitions","ProfileDOMID","ProfileOverviewDOMID","ProfileTabConst","ProfileTabUtils","ScriptPath","TimelineComponentKeys","TimelineController","TimelineDOMID","TimelineURI","UIPagelet","URI","$","ge","merge"],function(a,b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w){b.__markCompiled&&b.__markCompiled();var x=6,y='/profile_book.php',z=null,aa=null;function ba(ka){var la=t.getMostRecentURI(),ma=r.getSectionKeyFromURI(la),na=r.getTabKeyFromURI(la),oa=r.getVanityFromURI(la),pa=r.getSectionKeyFromURI(ka),qa=r.getTabKeyFromURI(ka),ra=r.getVanityFromURI(ka),sa=ka.getQueryData();if(oa!==ra||m.isActivityLogTab(qa)||qa===l.MEMORIAL_CONTACT||qa===l.POSTS||!!sa.and||r.isVideoPermalink(ka))return false;if(sa.hasOwnProperty('theater')){g.subscribeOnce('PhotoSnowlift.CLOSE',ia);return false;}if(m.isTimelineTab(na)&&!m.isTimelineTab(qa)&&ha(pa)){z=pa;ca(qa,'TimelineMedleyView',q.TAB_CONTENT,k.MEDLEY_ROOT,sa);return true;}if(!m.isTimelineTab(na)&&m.isTimelineTab(qa)){z=ma;ca(l.TIMELINE,'TimelineWallColumn',k.MEDLEY_ROOT,q.TAB_CONTENT,sa);return true;}return false;}function ca(ka,la,ma,na,oa){p.registerCurrentKey(ka);h.hide(u(ma));g.inform('save_facebar_query',true);var pa=v(na);if(pa){h.show(pa);ga(ka);}else da(la,ka,oa);}function da(ka,la,ma){ea();var na=w(aa,{tab_key:la});if(ma)na=w(na,ma);var oa=function(qa){fa();qa();},pa={append:true,displayCallback:oa,finallyHandler:ga.bind(null,la),usePipe:true};s.loadFromEndpoint(ka,j.MAIN_COLUMN_PERSONAL,na,pa);}function ea(){h.show(u(j.TAB_LOAD_INDICATOR));}function fa(){h.hide(u(j.TAB_LOAD_INDICATOR));}function ga(ka){var la=y;if(!m.isTimelineTab(ka))la+=':'+ka;n.set(la);i.transitionComplete();}function ha(ka){return z===null||ka===z;}function ia(){i.registerHandler(ba,x);}var ja={init:function(ka){aa=ka.profileContextData;p.register(o.ASYNC_NAV,this);ia();},reset:function(){aa=null;z=null;i.removeHandler(ba);}};e.exports=ja;},null);
__d("TimelineDrag",["ArbiterMixin","Event","Locale","Style","Vector","mixin"],function(a,b,c,d,e,f,g,h,i,j,k,l){b.__markCompiled&&b.__markCompiled();var m=l(g);for(var n in m)if(m.hasOwnProperty(n))p[n]=m[n];var o=m===null?null:m.prototype;p.prototype=Object.create(o);p.prototype.constructor=p;p.__superConstructor__=m;function p(q,r,s){"use strict";s=s||{};this._listenOn=s.listenOn;this._offsetInput=r;this._defaultOffset=s.default_offset;this._killClicks=s.killClicks;this._vertical=true;this._RTLXSwitch=false;this.setPicture(q,s);}p.prototype.setPicture=function(q,r){"use strict";if(!q)return false;r=r||{};this._picture=q;this._defaultOffset=r.default_offset;if(r.offsetInput)this._offsetInput=r.offsetInput;if(r.vertical!==(void 0))this._vertical=r.vertical;if(r.height)this._containerHeight=r.height;if(r.width)this._containerWidth=r.width;if(this._vertical){this._offsetType='top';this._eventCoord='y';}else{this._RTLXSwitch=i.isRTL();this._offsetType='left';this._eventCoord='x';}if(this._picture.complete){this._initialLoad();}else this._loadListener=h.listen(this._picture,'load',function(){this._loadListener.remove();this._loadListener=null;this._initialLoad();}.bind(this));};p.prototype.destroy=function(){"use strict";this._stopDrag();this._saveOffset();this._mousedown&&this._mousedown.remove();this._mousedown=null;this._onclick&&this._onclick.remove();this._onclick=null;this._loadListener&&this._loadListener.remove();this._loadListener=null;};p.prototype._initialLoad=function(){"use strict";var q=this._listenOn?this._listenOn:this._picture;this._mousedown&&this._mousedown.remove();this._mousedown=h.listen(q,'mousedown',this._onMouseDown.bind(this));if(this._vertical){this._maxOffset=this._containerHeight-this._picture.offsetHeight;}else this._maxOffset=this._containerWidth-this._picture.offsetWidth;if(this._defaultOffset!==(void 0))this._setOffset(this._defaultOffset);this._onclick&&this._onclick.remove();this._onclick=null;if(this._killClicks)this._onclick=h.listen(q,'click',this._onClick.bind(this));this._saveOffset();};p.prototype._onClick=function(event){"use strict";event.kill();};p.prototype._onMouseDown=function(event){"use strict";var q=parseInt(j.get(this._picture,this._offsetType),10)||0;this._pictureStartDragOffset=q-k.getEventPosition(event)[this._eventCoord];this._startDrag();event.kill();};p.prototype._startDrag=function(){"use strict";if(!this._dragStarted){this.inform('startdrag',this);this._dragTokens=[h.listen(document.documentElement,'mouseup',this._onMouseUp.bind(this)),h.listen(document.documentElement,'mousemove',this._onMouseMove.bind(this))];this._dragStarted=true;}};p.prototype._saveOffset=function(){"use strict";var q=parseInt(j.get(this._picture,this._offsetType),10);if(this._RTLXSwitch){this._offsetInput.value=q+this._containerWidth-this._picture.offsetWidth;}else this._offsetInput.value=q;};p.prototype._stopDrag=function(){"use strict";if(this._dragStarted){this.inform('stopdrag',this);this._dragStarted=false;this._dragTokens.forEach(function(q){q.remove();});this._saveOffset();}};p.prototype._onMouseUp=function(event){"use strict";this._stopDrag();event.kill();};p.prototype._setOffset=function(q){"use strict";if(this._RTLXSwitch){q=Math.max(0,Math.min(q,-this._maxOffset));}else q=Math.min(0,Math.max(q,this._maxOffset));j.set(this._picture,this._offsetType,q+'px');};p.prototype._onMouseMove=function(event){"use strict";this._setOffset(this._pictureStartDragOffset+k.getEventPosition(event)[this._eventCoord]);event.kill();};e.exports=p;},null);
__d("TimelineCover",["Arbiter","Button","CSS","DOM","DOMScroll","Event","FileInputUploader","HTML","PageTransitions","Parent","Run","Style","TimelineDrag","$","cx","fbt","ge","tidyEvent"],function(a,b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w,x){b.__markCompiled&&b.__markCompiled();function y(z,aa,ba){"use strict";this.root=t('fbProfileCover');if(typeof aa==='object'){this._coverHeight=aa.cover_height;this._coverWidth=aa.cover_width;this.previewing=aa.previewing;this._isLegacy=false;}else{this._isLegacy=true;this._coverHeight=aa;this.previewing=ba;}this._parentSection=p.byClass(this.root,'fbTimelineSection');this.cover=j.find(this.root,'.cover');y.instance=this;this.editing=false;q.onBeforeUnload(this.onBeforeUnload.bind(this));if(!this._parentSection)this._parentSection=p.byClass(this.root,'fbEventHeader');if(this.previewing){this.editMode();this.updateCoverImage(this.previewing);}}y.prototype.showLoadingIndicator=function(){"use strict";var z=w('fbCoverImageContainer');if(z)i.addClass(z,'opaquedLoading');};y.prototype.hideLoadingIndicator=function(){"use strict";var z=w('fbCoverImageContainer');if(z)i.removeClass(z,'opaquedLoading');};y.prototype.onBeforeUnload=function(){"use strict";if(this.isInEditMode())return v._("If you leave this page, your cover photo will not be saved. To save, press the \"save\" button below your cover photo.");};y.prototype.isCoverImageVerticalFlow=function(z){"use strict";return !(z.style.height);};y.prototype.editMode=function(){"use strict";h.setEnabled(j.find(this.root,'button.cancelButton'),true);h.setEnabled(j.find(this.root,'button.saveButton'),true);this.hideLoadingIndicator();this._coverImage=j.scry(this.root,'.coverImage')[0];var z=j.scry(this._coverImage,'.coverWrap')[0];if(z){var aa=j.find(z,'.coverPhotoImg');this._originalIsVertical=this.isCoverImageVerticalFlow(aa);this._originalOffset=r.get(aa,this._originalIsVertical?'top':'left');}i.addClass(this._parentSection,'fbEditCover');k.scrollTo(this.root);if(this.previewing){j.remove(this._coverImage);i.show(this._coverImage);}var ba=j.scry(this._coverImage,'.coverPhotoImg')[0];if(ba)this._createDragger();this.editing=true;g.inform('CoverPhotoEdit',{sender:this,state:"open"});};y.prototype._exitEditMode=function(){"use strict";if(this._timelineDrag){this._timelineDrag.destroy();this._timelineDrag=null;}j.find(this.root,'input.hiddenPhotoID').value=null;h.setEnabled(j.find(this.root,'button.cancelButton'),false);h.setEnabled(j.find(this.root,'button.saveButton'),false);i.removeClass(this._parentSection,'fbEditCover');this.hideLoadingIndicator();this.previewing=false;g.inform('CoverPhotoEdit',{sender:this,state:"closed"});this.editing=false;};y.prototype._createDragger=function(z){"use strict";var aa;if(this._isLegacy){aa=j.find(this.root,'input.photoOffsetInput');this._originalIsVertical=true;}else{var ba=z===(void 0)?this._originalIsVertical:z;aa=ba?j.find(this.root,'input.photoOffsetYInput'):j.find(this.root,'input.photoOffsetXInput');}this._timelineDrag=new s(j.find(this.root,'.coverImage .coverPhotoImg'),aa,{height:this._coverHeight,width:this._coverWidth,listenOn:this.cover,vertical:ba,killClicks:true});};y.prototype.updateCoverImage=function(z,aa){"use strict";if(aa)this.editMode();j.find(this.root,'input.hiddenPhotoID').value=z;h.setEnabled(j.find(this.root,'button.saveButton'),true);if(aa)j.replace(j.find(this.root,'.coverImage'),typeof aa==='string'?n(aa):aa);var ba=j.find(j.find(this.root,'.coverImage'),'.coverPhotoImg'),ca=this.isCoverImageVerticalFlow(ba),da;if(this._isLegacy){da=j.find(this.root,'input.photoOffsetInput');}else da=ca?j.find(this.root,'input.photoOffsetYInput'):j.find(this.root,'input.photoOffsetXInput');if(this._timelineDrag){this._timelineDrag.setPicture(ba,{offsetInput:da,vertical:ca});}else this._createDragger(ca);this._updateHeader();};y.prototype.cancelUpdate=function(){"use strict";this._reloadAfterNextUpdate=false;j.remove(j.scry(this.root,'.coverImage')[0]);j.prependContent(this.cover,this._coverImage);if(this._originalOffset!==(void 0))r.set(j.find(this._coverImage,'.coverPhotoImg'),this._originalIsVertical?'top':'left',this._originalOffset);this._exitEditMode();this._updateHeader();};y.prototype.saveComplete=function(){"use strict";if(this._reloadAfterNextUpdate)a.location.reload();this._coverImage=j.scry(this.root,'.coverImage')[0];var z=p.byClass(this.root,'fbTimelineTopSectionBase');z&&i.removeClass(z,"_6_5");this._exitEditMode();this._updateHeader();o.rewriteCurrentURI(o.getCurrentURI().getUnqualifiedURI(),o.getCurrentURI().removeQueryData('preview_cover'));};y.prototype.isInEditMode=function(){"use strict";return this.editing;};y.prototype._updateHeader=function(){"use strict";var z=j.scry(this.root,'.coverImage')[0];if(!z)return;var aa=i.hasClass(z,'coverNoImage'),ba=i.hasClass(this._parentSection,'noCoverImage');if(aa!==ba)i.conditionClass(this._parentSection,'noCoverImage',aa);};y.getInstance=function(){"use strict";return y.instance;};y.staticUpdateCoverImage=function(z){"use strict";y.getInstance().updateCoverImage(null,z);};y.prototype.setupFileUpload=function(z,aa,ba){"use strict";z.subscribe('change',function(){var ca=new m(z.getInput()).setURI(aa).setAllowCrossOrigin(true);ca.subscribe('failure',function(){y.showErrorDialog(v._("Cover Upload Failed"),v._("Uploading the new cover picture failed. Please try again."));});ca.subscribe(['success','failure'],function(){this.hideLoadingIndicator();z.clear();i.removeClass(z.getControl(),ba);z.getInput().disabled=false;}.bind(this));this.showLoadingIndicator();this._reloadAfterNextUpdate=true;ca.send();i.addClass(z.getControl(),ba);z.getInput().disabled=true;}.bind(this));};y.setupFileUpload=function(z,aa,ba){"use strict";this.getInstance().setupFileUpload(z,aa,ba);};y.imageUploadDone=function(z,aa){"use strict";this.getInstance().updateCoverImage(z,aa);};y.showErrorDialog=function(z,aa){"use strict";new Dialog().setTitle(z).setButtons(Dialog.OK).setBody(aa).show();this.getInstance().hideLoadingIndicator();};y.initFileUploadMenu=function(z){"use strict";y.showLoadingAfterFileUpload(z.getForm());};y.showLoadingAfterFileUpload=function(z){"use strict";x(z.subscribe('submit',function(){y.getInstance().showLoadingIndicator();}));};y.instance=null;e.exports=y;},null);
__d("TimelineLoadState",[],function(a,b,c,d,e,f){b.__markCompiled&&b.__markCompiled();var g={NOT_LOADED:0,LOADING:1,LOADED:2};e.exports=g;},null);
__d("TimelineNavLight",["CSS","DOM","DOMQuery","Parent","ProfileOverviewDOMID","TimelineAppSectionConstants","TimelineComponentKeys","TimelineController","ProfileOverviewSection","csx","cx"],function(a,b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q){b.__markCompiled&&b.__markCompiled();var r="_6-7",s="_529n",t="_5215",u="_70k",v="._6-7",w="._6-6";function x(y){"use strict";this.$TimelineNavLight0=i.scry(y,v)[0];this.$TimelineNavLight1=i.scry(y,w);var z=j.byClass(y,u).offsetWidth,aa=this.$TimelineNavLight1[this.$TimelineNavLight1.length-1];if(aa.offsetLeft+aa.offsetWidth>z)g.addClass(y,t);for(var ba=this.$TimelineNavLight1.length-1;ba>1;ba--)if(this.$TimelineNavLight1[ba].offsetLeft+this.$TimelineNavLight1[ba].offsetWidth>z){h.remove(this.$TimelineNavLight1[ba]);}else break;g.removeClass(j.byClass(y,s),s);o.subscribe('Medley/transitionToSection',function(ca,da){this.$TimelineNavLight3(da.slice(k.PREFIX_MEDLEY.length));}.bind(this));n.register(m.COVER_NAV,this);}x.prototype.handleTabChange=function(y){"use strict";this.$TimelineNavLight3(y);};x.prototype.$TimelineNavLight3=function(y){"use strict";this.$TimelineNavLight0&&g.removeClass(this.$TimelineNavLight0,r);this.$TimelineNavLight1.some(function(z){var aa=l.collectionTabKeyToAppTabKey[y]||y;if(z.getAttribute('data-tab-key')===aa){g.addClass(z,r);this.$TimelineNavLight0=z;return true;}}.bind(this));};e.exports=x;},null);
__d("TimelineSectionStore",["TimelinePageLoadParam","KeyedCallbackManager","mixInEventEmitter"],function(a,b,c,d,e,f,g,h,i){b.__markCompiled&&b.__markCompiled();var j=new h(),k='num_reports_tried',l='num_reports_visible',m='more_pager_data',n='finished',o={getDataToLoadNextSegment:function(p,q){j.executeOrEnqueue(p,function(r){this._mergeReportsAndStoriesDataCallback(r,q);}.bind(this));},setSectionFinished:function(p,q){var r=this._getSectionData(p);if(!r[n])r[n]={};r[n][q]=true;j.setResource(p,r);if(r[n].stories&&r[n].reports)this.emitAndHold('section_finished',p);},setReportsData:function(p,q,r){var s=this._getSectionData(p);s[k]=q;s[l]=r;j.setResource(p,s);},setStoriesData:function(p,q){var r=this._getSectionData(p);r[m]=q;j.setResource(p,r);},_getSectionData:function(p){var q=j.getResource(p);return q||{};},_mergeReportsAndStoriesDataCallback:function(p,q){var r=p[m];if(!r.hasOwnProperty(g.REQUEST_PARAM_NAME))r[g.REQUEST_PARAM_NAME]={};r[g.REQUEST_PARAM_NAME][g.REPORT_UNIT_COUNT]=p[k];var s=r[g.REQUEST_PARAM_NAME][g.VISIBLE_UNIT_COUNT];r[g.REQUEST_PARAM_NAME][g.VISIBLE_UNIT_COUNT]=s+p[l];q(r);}};i(o,{section_finished:true});e.exports=o;},null);
__d("TimelineSectionPager.react",["Arbiter","DataStore","Link.react","React","ReactComponentWithPureRenderMixin","TimelineConstants","TimelineLegacySections","TimelineLoadState","TimelineSectionStore","UIPagelet","FeedPlaceHolderStory.react","OnVisible.react","$","cx","keyMirror"],function(a,b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u){b.__markCompiled&&b.__markCompiled();var v=j,w=v.PropTypes,x=null,y={},z=u({LINK:null,LOADING:null,ON_VISIBLE:null}),aa=500,ba=j.createClass({displayName:"TimelineSectionPager",_storeListener:x,_sectionLoadSubscription:x,mixins:[k],propTypes:{loadMoreLabel:w.string.isRequired,sectionKey:w.string.isRequired,rootID:w.string.isRequired},componentWillMount:function(){y[this.props.sectionKey]=this;this._storeListener=o.addListener('section_finished',this._handleSectionFinished);this._sectionLoadSubscription=g.subscribe(l.SECTION_FULLY_LOADED,this._handleSectionLoad);},getInitialState:function(){return {buffer:aa,pagerState:z.ON_VISIBLE};},render:function(){if(this.state.pagerState===z.LINK)return (j.createElement(i,{className:"_3g20",onClick:this._onPagerClick},this.props.loadMoreLabel));var ca=j.createElement(q,{className:"_lr_"});if(this.state.pagerState===z.LOADING)return ca;return (j.createElement(r,{buffer:this.state.buffer,onVisible:this._loadNextSegment},ca));},componentWillUnmount:function(){this._storeListener.remove();this._sectionLoadSubscription.unsubscribe();y[this.props.sectionKey]=null;},statics:{getInstance:function(ca){return y[ca];}},removeOnVisible:function(){this.setState({pagerState:z.LINK});},restoreOnVisible:function(){this.setState({pagerState:z.ON_VISIBLE});},_onPagerClick:function(){var ca=m.get(this.props.sectionKey);if(ca)ca.activateContentScrollLoad();this._loadNextSegment();},_loadNextSegment:function(){var ca=m.get(this.props.sectionKey);if(ca&&ca.hasPendingCallbacks()){ca.runPendingDisplayCallbacks();this._onLoadComplete();}else this.setState({pagerState:z.LOADING},function(){return o.getDataToLoadNextSegment(this.props.sectionKey,this._nextSegmentDataHandler);}.bind(this));},_nextSegmentDataHandler:function(ca){var da=m.get(this.props.sectionKey);if(da){this._loadPagelet(ca);return;}var ea=g.subscribe(l.SECTION_REGISTERED,function(fa,ga){if(ga.scrubberKey===this.props.sectionKey){this._loadPagelet(ca);ea.unsubscribe();}}.bind(this));},_loadPagelet:function(ca){var da=ca.page_index,ea=m.get(this.props.sectionKey);if(!ea)return;var fa=ea.getPageLoadStatus(da);if(fa!==n.NOT_LOADED){this._enableNextPage();return;}var ga=function(ia){return this._pageletDisplay(da,ia);}.bind(this),ha={append:true,constHeight:true,crossPage:true,displayCallback:ga,finallyHandler:this._onLoadComplete,jsNonblock:true,usePipe:true};ea.setPageLoadStatus(da,n.LOADING);p.loadFromEndpoint('ProfileTimelineSectionPagelet',ca.unit_container_id,ca,ha);},_handleSectionFinished:function(ca){if(ca===this.props.sectionKey)j.unmountComponentAtNode(s(this.props.rootID));},_handleSectionLoad:function(ca,da){if(da.scrubberKey===this.props.sectionKey){var ea=m.get(this.props.sectionKey),fa=0;if(ea&&!ea.isRightColumnFinished())fa=h.get(l.DS_COLUMN_HEIGHT_DIFFERENTIAL,this.props.sectionKey);this.setState({buffer:Math.abs(fa)+aa});}},_canScrollLoad:function(){var ca=m.get(this.props.sectionKey);return !!ca&&ca.canContentScrollLoad();},_onLoadComplete:function(){if(this.isMounted())this._enableNextPage();},_enableNextPage:function(){this.setState({pagerState:this._canScrollLoad()?z.ON_VISIBLE:z.LINK});},_pageletDisplay:function(ca,da){var ea=m.get(this.props.sectionKey);if(ea){ea.setPageLoadStatus(ca,n.LOADED);if(ea.canContentScrollLoad()){da();}else ea.queueDisplayCallback(ca,da);}}});e.exports=ba;},null);
__d("TimelineUnitSelector",["DOMQuery","csx"],function(a,b,c,d,e,f,g,h){b.__markCompiled&&b.__markCompiled();var i={getUnitsWithTime:function(j){return g.scry(j,"._5jmm[data-time]");}};e.exports=i;},null);
__d("TimelineComposerUtilities",["Event","Arbiter","Bootloader","CSS","DOM","DOMQuery","Parent","TimelineUnitSelector","Vector","cx"],function(a,b,c,d,e,f,g,h,i,j,k,l,m,n,o,p){b.__markCompiled&&b.__markCompiled();var q=86400*31,r=86400000,s={listenToSetEstimatedDate:function(t,u){return h.subscribe('ComposerXTimelineTagger/init',function(v,w){if(l.contains(t,w.datePickerElement)){s.setEstimatedDate(w.datePickerInstance,u());w.composerTimelineTagger.switchToTagger('date');}});},listenToPublish:function(t,u){if(t.root)t=t.root;return h.subscribe('composer/publish',function(event,v){if(v.composer_id===t.id)i.loadModules(["TimelineStoryPublisher"],function(w){w.publish(v);u&&u();});});},listenToAnotherComposerOpen:function(t,u){return h.subscribe('composer/mutate',function(v,w){if(w!==t)u();});},listenToCancel:function(t,u){return g.listen(t,'click',function(event){if(m.byClass(event.getTarget(),"_306"))u();});},setEstimatedDate:function(t,u){var v,w;if(u&&j.hasClass(u,'fbTimelineCapsule')){v=u.getAttribute('data-start');w=u.getAttribute('data-end');if(v&&w){var x=new Date(w*1000),y=new Date();if(x>y){t.setDate(y.getFullYear(),y.getMonth()+1,y.getDate());}else if(w-v>2*q){t.setDate(x.getFullYear());}else t.setDate(x.getFullYear(),x.getMonth()+1);}return;}var z=m.byClass(u,'fbTimelineCapsule');if(z){v=z.getAttribute('data-start');w=z.getAttribute('data-end');var aa=o.getElementPosition(u).y,ba=[w,null],ca=[v,null],da=n.getUnitsWithTime(z);for(var ea=0;ea<da.length;ea++){var fa=da[ea],ga=k.scry(fa.parentNode,'.spinePointer')[0];if(!ga)continue;var ha=o.getElementPosition(ga).y;if(ha<=aa){if(!ba[1]||ha>ba[1])ba=[fa.getAttribute('data-time'),ha];}else if(!ca[1]||ha<ca[1])ca=[fa.getAttribute('data-time'),ha];}if(ba[0]!==null&&ca[0]!==null){var ia=Math.round((parseInt(ba[0],10)+parseInt(ca[0],10))/2)*1000;ia=Math.min(new Date()-r,ia);t.setDateWithTimestamp(ia);}}}};e.exports=s;},null);
__d("TimelineSection",["Arbiter","CSS","DOM","Parent","ScrollingPager","TimelineConstants","TimelineLegacySections","TimelineLoadState","TimelineScrubberKey","UIPagelet","TimelineSectionPager.react","merge"],function(a,b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r){b.__markCompiled&&b.__markCompiled();function s(t,u,v,w,x){"use strict";this.node=t;this.loaded=w;this._canScrollLoad=true;this._canContentScrollLoad=true;this._canUnload=u!==o.RECENT_ACTIVITY;this.scrubberKey=u;this._historicUnitCount=x;this._pageletLoadData=v;this._expandPageletLoadData={};this._rightColumnFinished=false;this._pendingDisplayCallbacks=[];this._hidden=false;this._pageLoadStatus=[];}s.prototype.load=function(t,u){"use strict";if(this.loaded){this.activateContentScrollLoad();return;}var v=this._pageletLoadData;g.inform(l.SECTION_LOADING,{data:v,scrubberKey:this.scrubberKey});this.loaded=true;h.removeClass(this.node,'fbTimelineTimePeriodUnexpanded');h.removeClass(this.node,'fbTimelineTimePeriodSuppressed');var w='ProfileTimelineSectionPagelet',x=this.scrubberKey===o.WAY_BACK;if(x)w='ProfileTimelineRemainingYearsPagelet';var y=m.shouldForceNoFriendActivity();v=r(v,{highlight_unit_data:t,parent_key:this.parentKey,force_no_friend_activity:y});h.addClass(this.node,'fbTimelineSectionLoading');this._canScrollLoad=false;this.activateContentScrollLoad();var z=null;if(u){this.node.style.minHeight=window.innerHeight+'px';z=function(){this.node.style.minHeight='';m.destroyOnVisible(this.scrubberKey);}.bind(this);}m.addLoadPagelet(this.scrubberKey,p.loadFromEndpoint(w,this.node.id,v,{usePipe:true,jsNonblock:true,constHeight:true,append:false,finallyHandler:z}));m.collapsePlaceHolderHeaders();};s.prototype.preload=function(){"use strict";h.addClass(this.node,'fbTimelineTimePeriodSuppressed');h.removeClass(this.node,'fbTimelineTimePeriodUnexpanded');var t=i.find(this.node,'span.sectionLabel');if(t.getAttribute('data-original-label')){i.setContent(t,t.getAttribute('data-original-label'));t.removeAttribute('data-original-label');}};s.prototype.unload=function(){"use strict";if(!this.loaded||!this._canUnload)return;this.loaded=false;m.cancelLoadPagelet(this.scrubberKey);h.addClass(this.node,'fbTimelineTimePeriodUnexpanded');h.removeClass(this.node,'fbTimelineTimePeriodSuppressed');if(this.node.nextSibling&&h.hasClass(this.node.nextSibling,'fbTimelineSection')){i.setContent(this.node,this.node.nextSibling);h.show(this.node.firstChild);}else i.empty(this.node);this.deactivateScrollLoad();};s.prototype.canScrollLoad=function(){"use strict";return this._canScrollLoad;};s.prototype.activateScrollLoad=function(){"use strict";this._canScrollLoad=true;h.removeClass(this.node,'fbTimelineTimePeriodSuppressed');h.addClass(this.node,'fbTimelineTimePeriodUnexpanded');var t=m.getOnVisible(this.scrubberKey);if(t)t.reset();return this;};s.prototype.deactivateScrollLoad=function(){"use strict";if(!this.loaded){this._canScrollLoad=false;h.removeClass(this.node,'fbTimelineTimePeriodUnexpanded');h.addClass(this.node,'fbTimelineTimePeriodSuppressed');var t=m.getOnVisible(this.scrubberKey);if(t)t.remove();}i.scry(this.node,'.fbTimelineSectionExpandPager').forEach(function(u){var v=k.getInstance(u.id);v&&v.removeOnVisible();var w=j.byClass(u,'stat_elem');if(w)h.removeClass(w,'async_saving');});return this;};s.prototype.canContentScrollLoad=function(){"use strict";return this._canContentScrollLoad;};s.prototype.activateContentScrollLoad=function(){"use strict";this._canContentScrollLoad=true;var t=q.getInstance(this.scrubberKey);if(t)t.restoreOnVisible();return this;};s.prototype.deactivateContentScrollLoad=function(){"use strict";this._canContentScrollLoad=false;var t=q.getInstance(this.scrubberKey);if(t)t.removeOnVisible();return this;};s.prototype.isRightColumnFinished=function(){"use strict";return this._rightColumnFinished;};s.prototype.setRightColumnFinished=function(){"use strict";this._rightColumnFinished=true;return this;};s.prototype.getHistoricUnitCount=function(){"use strict";return this._historicUnitCount;};s.prototype.setExpandLoadData=function(t){"use strict";this._expandPageletLoadData=t;return this;};s.prototype.expand=function(t){"use strict";if(!this.loaded)return;var u=i.find(this.node,'.fbTimelineSectionExpander');h.addClass(u.firstChild,'async_saving');t&&h.addClass(t,'async_saving');g.inform(l.SECTION_EXPAND,this.scrubberKey);i.scry(this.node,'.fbTimelineCapsule').forEach(i.remove);this._expandPageletLoadData.new_expand=true;m.cancelLoadPagelet(this.scrubberKey);m.addLoadPagelet(this.scrubberKey,p.loadFromEndpoint('ProfileTimelineSectionPagelet',u.id,this._expandPageletLoadData,{usePipe:true,jsNonblock:true,constHeight:true}));};s.prototype.isPermalinkPeriod=function(){"use strict";return this._pageletLoadData.is_permalink_period;};s.prototype.isHidden=function(){"use strict";return this._hidden;};s.prototype.hide=function(){"use strict";this._hidden=true;h.hide(i.find(this.node,'.fbTimelineSection'));return this;};s.prototype.isHiddenFromView=function(){"use strict";return (!this.loaded||this._hidden||h.hasClass(this.node,'fbTimelineTimePeriodUnexpanded'));};s.prototype.hasPendingCallbacks=function(){"use strict";return this._pendingDisplayCallbacks.length>0;};s.prototype.queueDisplayCallback=function(t,u){"use strict";this._pendingDisplayCallbacks[t]=u;return this;};s.prototype.runPendingDisplayCallbacks=function(){"use strict";while(this.hasPendingCallbacks())this._pendingDisplayCallbacks.shift()();return this;};s.prototype.setPageLoadStatus=function(t,u){"use strict";this._pageLoadStatus[t]=u;return this;};s.prototype.getPageLoadStatus=function(t){"use strict";if(this._pageLoadStatus[t]===(void 0))this._pageLoadStatus[t]=n.NOT_LOADED;return this._pageLoadStatus[t];};e.exports=s;},null);
__d("TimelineContentLoader",["Arbiter","CSS","DOM","DOMScroll","Event","OnVisible","Parent","ScrollingPager","TimelineComponentKeys","TimelineConstants","TimelineController","TimelineDOMID","TimelineLegacySections","TimelineScrubberKey","TimelineSection","TimelineSectionStore","TimelineSmartInsert","Vector","$","arrayContains","copyProperties","createArrayFromMixed","csx","debounce","ge"],function(a,b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w,x,y,z,aa,ba,ca,da,ea){b.__markCompiled&&b.__markCompiled();var fa=false,ga=null,ha={},ia={},ja=[],ka={},la=null,ma=null,na=null,oa=80,pa=250,qa=500;function ra(){if(fa)return;q.register(o.CONTENT,xa);ma=g.subscribe(p.SECTION_EXPAND,function(ya,za){xa.navigateToSection(za);});na=v.addRetroactiveListener('section_finished',ua);fa=true;}var sa=da(function(ya,za,ab){var bb=s.get(ya).getHistoricUnitCount();za-=bb;ab-=1;if(bb==-1||ab<=0||za<0)return;var cb=xa.getNextSectionKey(ya);if(cb){s.get(cb).load();sa(cb,za,ab);}},qa);function ta(ya,za){if(!za)za=0;if(za<oa&&!ya())setTimeout(ta.bind(null,ya,za+1),pa);}function ua(ya){ta(function(){if(ya===t.WAY_BACK)return true;var za=xa.getNextSectionKey(ya);if(za){wa(za);return true;}return false;});}function va(ya,za,ab){ta(function(){if(za===t.WAY_BACK)return true;var bb=xa.getNextSectionKey(za);if(bb){s.addOnVisible(bb,new l(ya,wa.bind(null,bb),false,ab||1000));return true;}return false;});}function wa(ya){var za=s.get(ya);if(za&&za.canScrollLoad()){za.load();if(la)sa(ya,la.required_units,la.max_parallelism);}}var xa={CURRENT_SECTION_OFFSET:150,registerTimePeriod:function(ya,za,ab,bb,cb,db,eb){ra();if(z(ja,za))return;if(ia)aa(ab,ia);var fb=new u(ya,za,ab,bb,eb);if(!cb){s.setMainSectionOrder(za,db);ha[za]=true;}else{fb.parentKey=cb;s.get(cb).subSections=s.get(cb).subSections||[];s.get(cb).subSections[db]=fb;}s.set(za,fb);xa.checkCurrentSectionChange();g.inform(p.SECTION_REGISTERED,{scrubberKey:za,period:fb});},reset:function(){s.removeAllOnVisibles();s.cancelLoadPagelets();for(var ya in ka){ka[ya].unsubscribe();delete ka[ya];}ma&&ma.unsubscribe();ma=null;na&&na.remove();na=null;s.removeAll();ga=null;ha={};ia={};ja=[];fa=false;},checkCurrentSectionChange:function(){var ya=xa.getCurrentSection(),za=ga&&ga.scrubberKey;if(ya&&ya.scrubberKey!==za&&!ya.isPermalinkPeriod()){ga=ya;var ab=ya.scrubberKey,bb=ya.parentKey;if(!bb){bb=ab;ab=null;}q.sectionHasChanged(bb,ab);}},setParallelLoadConfig:function(ya){la=ya;},getCurrentSection:function(){var ya={},za=s.getAll();for(var ab in za){var bb=za[ab];if(!bb||bb.isHiddenFromView())continue;var cb=x.getElementPosition(bb.node,'viewport').y;if(bb.scrubberKey===t.RECENT_ACTIVITY)cb--;if(cb<xa.CURRENT_SECTION_OFFSET)ya[cb]=bb;}var db=Math.max.apply(null,Object.keys(ya)),eb=s.getMainSectionOrder(),fb=db==-Infinity;if(!fb){return ya[db];}else if(eb[0])return s.get(eb[0]);return null;},getLastVisibleSection:function(){var ya=s.getMainSectionOrder();for(var za=ya.length-1;za>=0;za--){var ab=s.get(ya[za]);if(ab&&!ab.isHiddenFromView())return ab;}return null;},getRecentActivitySection:function(){return s.get(t.RECENT_ACTIVITY);},capsuleForCurrentSection:function(){var ya=xa.getCurrentSection();return ya&&i.scry(ya.node,'.fbTimelineCapsule')[0];},enableScrollLoad:function(ya,za,ab,bb){ya=y(ya);var cb=m.byClass(ya,'fbTimelineSection')||ya.parentNode,db=cb&&i.scry(cb,'.fbTimelineCapsule')[0];if(!db)return;if(ab===null){va(ya,za,bb);}else q.runOnceWhenSectionFullyLoaded(va.bind(null,ya,za,bb),za,ab);},expandSectionOnClick:function(ya,za){k.listen(ya,'click',function(ab){ab.prevent();s.get(za).expand();});},expandSubSectionsOnClick:function(ya,za){k.listen(ya,'click',function(ab){ab.prevent();s.cancelLoadPagelet(za);var bb=s.get(za);if(bb.subSections.length)xa.navigateToSection(bb.subSections[0].scrubberKey);});},getNextSectionKey:function(ya){var za=s.getMainSectionOrder();for(var ab=0;ab<za.length-1;ab++)if(za[ab]==ya){while(ab<za.length-1&&!za[ab+1])ab++;return za[ab+1];}var bb=s.get(ya);if(!bb||!bb.parentKey)return;var cb=s.get(bb.parentKey);if(!cb)return;for(var db=0;db<cb.subSections.length-1;db++)if(cb.subSections[db].scrubberKey==ya)return cb.subSections[db+1].scrubberKey;},hideSection:function(ya){var za=s.get(ya);if(za)za.hide();var ab=q.getCurrentScrubber();if(ab){var bb=null;if(!ha[ya]){var cb=za.parentKey;bb=q.getCurrentScrubber().getSubnav(cb,ya);}else bb=q.getCurrentScrubber().getNav(ya);bb&&h.hide(bb);}var db=q.getCurrentStickyHeaderNav();db&&db.removeTimePeriod(ya);},loadSectionOnClick:function(ya,za){k.listen(ya,'click',function(ab){ab.prevent();s.get(za).load();});},removeSection:function(ya){s.removeOnVisible(ya);s.remove(ya);delete ha[ya];var za=q.getCurrentStickyHeaderNav();za&&za.removeTimePeriod(ya);ja.push(ya);},removeSectionParent:function(ya){i.remove(y(ya).parentNode);},navigateToSection:function(ya,za,ab){za=!!za;var bb=ya,cb=s.get(ya);if(!cb)return;if(!cb.loaded){w.enable();i.scry(y(r.TAB_CONTENT),'.fbTimelineShowOlderSections').forEach(i.remove);}if(!ha[ya]){if(!cb.loaded)cb.node.style.minHeight=x.getViewportDimensions().y+'px';var db=g.subscribe(p.SECTION_FULLY_LOADED,function(mb,nb){if(nb.scrubberKey===ya){cb.node.style.minHeight='';db.unsubscribe();}});bb=cb.parentKey;var eb=s.get(bb).node;if(!h.hasClass(eb,'fbTimelineSectionExpanded')){j.scrollTo(eb,0);h.addClass(eb,'fbTimelineSectionExpanded');i.scry(eb,'.fbTimelineCapsule').forEach(i.remove);i.scry(eb,'div.fbTimelineSectionExpandPager').forEach(i.remove);i.scry(eb,'div.fbTimelineContentHeader').forEach(i.remove);i.scry(eb,"._5vf").forEach(function(mb){if(!mb.getAttribute('data-subsection'))i.remove(mb);});}var fb=xa.getNextSectionKey(bb),gb=s.getOnVisible(fb);if(gb)gb.setBuffer(0);}var hb=s.getMainSectionOrder();for(var ib=0;ib<hb.length;ib++){var jb=hb[ib];if(!jb)continue;if(jb==bb)break;s.get(jb).deactivateScrollLoad().deactivateContentScrollLoad();}cb.load(ab,true);s.collapsePlaceHolderHeaders();var kb=x.getScrollPosition().x,lb=x.getElementPosition(cb.node).y;if(!za)j.scrollTo(new x(kb,lb-p.SCROLL_TO_OFFSET,'document'),true,false,false,0,function(){var mb=x.getElementPosition(cb.node).y;j.scrollTo(new x(kb,mb-p.SCROLL_TO_OFFSET,'document'),false);var nb=i.scry(cb.node,'h3.uiHeaderTitle')[0];if(nb){nb.tabIndex=0;nb.focus();}});},appendContentAfterLoad:function(ya,za,ab){q.runOnceWhenSectionFullyLoaded(i.appendContent.bind(null,y(ya),za),ab,'0');},markSectionAsLoaded:function(ya,za,ab){q.runOnceWhenSectionFullyLoaded(function(){ea(ya)&&h.removeClass(y(ya).parentNode,'fbTimelineSectionLoading');},za,ab);},suppressSectionsAbove:function(ya){var za,ab,bb=s.getMainSectionOrder();for(var cb=0;cb<bb.length;cb++){var db=bb[cb];if(!db)continue;za=s.get(db).node;ab=null;if(ba(ya.parentNode.children).indexOf(ya)<=ba(za.parentNode.children).indexOf(za)){ab=db;break;}s.get(db).deactivateScrollLoad();}if(ab)xa.navigateToSection(ab,true);},forceNoFriendActivity:function(){s.forceNoFriendActivity();},removeDupes:function(ya){var za=ea(ya);if(!za)return;var ab=i.scry(za,'li.fbTimelineUnit'),bb={};for(var cb=0;cb<ab.length;cb++){var db=ab[cb];if(db.id&&db.id.startsWith('tl_unit_')){var eb=db.id.substring(8,db.id.length),fb=i.scry(db,'div.timelineUnitContainer');if(fb.length>0)eb=eb+fb[0].getAttribute('data-time');if(bb.hasOwnProperty(eb)){db.id='dupe_unit_'+Math.random();db.className="hidden_elem";}else bb[eb]=1;}}},removeLoadingState:function(ya){ea(ya)&&h.removeClass(y(ya),'fbTimelineSectionLoading');},setExpandLoadDataForSection:function(ya,za){var ab=s.get(ya);ab&&ab.setExpandLoadData(za);},updatePagerAfterLoad:function(ya,za,ab,bb,cb){var db=n.getInstance(ya.firstChild.id);if(!db){ka[ya.firstChild.id]=g.subscribe(n.REGISTERED,function(fb,gb){ka[ya.firstChild.id].unsubscribe();delete ka[ya.firstChild.id];if(gb.id===ya.firstChild.id)xa.updatePagerAfterLoad(ya,za,ab,bb,cb);});return;}var eb=db.getHandler();db.setHandler(function(fb){h.addClass(ya,'async_saving');eb(fb);});q.runOnceWhenSectionFullyLoaded(function(){h.removeClass(ya,'fbTimelineHiddenPager');db.checkBuffer();},ab,bb);if(cb)q.runOnceWhenSectionFullyLoaded(q.adjustScrollingPagerBuffer.bind(null,ya.firstChild.id,ab),ab,bb);},repositionDialog:function(ya){g.subscribe(p.SECTION_LOADED,function(){ya.updatePosition();});},rightColumnFinished:function(ya){var za=s.get(ya);za.setRightColumnFinished();},addUnrankedUnits:function(ya){var za=y(ya),ab=i.scry(za,'li.fbTimelineUnit');for(var bb=ab.length-1;bb>=0;bb--){var cb=ab[bb];i.insertAfter(za,cb);h.addClass(i.find(cb,'div.timelineUnitContainer'),'fbTimelineHighlightUnit');}i.remove(za);},addUnrankedStories:function(ya){var za=y(ya),ab=i.scry(za,"._5pat");for(var bb=ab.length-1;bb>=0;bb--){var cb=ab[bb];i.insertAfter(za,cb);}i.remove(za);g.inform('Timeline/unrankedStoriesLoaded');}};e.exports=xa;},null);
__d("legacy:TimelineCover",["TimelineCover"],function(a,b,c,d){b.__markCompiled&&b.__markCompiled();a.TimelineCover=b('TimelineCover');},3);